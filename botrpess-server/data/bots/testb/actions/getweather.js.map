{"version":3,"sources":["../bot-templates/weatherbot/actions/getweather.js"],"names":["axios","require","myAction","config","bp","getModuleConfig","apiKey","openWeatherApiKey","query","event","payload","text","response","get","error","status","Error","city","data","name","country","sys","temperature","main","temp","description","weather"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;AAEA;;;;;;;;AAMA,MAAMC,QAAQ,GAAG,YAAY;AAC3B,QAAMC,MAAM,GAAG,MAAMC,EAAE,CAACD,MAAH,CAAUE,eAAV,CAA0B,UAA1B,CAArB;AACA,QAAMC,MAAM,GAAGH,MAAM,CAACI,iBAAtB;AACA,QAAMC,KAAK,GAAGC,KAAK,CAACC,OAAN,CAAcC,IAA5B;AAEA,MAAIC,QAAJ;;AACA,MAAI;AACFA,IAAAA,QAAQ,GAAG,MAAMZ,KAAK,CAACa,GAAN,CAAW,oDAAmDL,KAAM,uBAAsBF,MAAO,EAAjG,CAAjB;AACD,GAFD,CAEE,OAAOQ,KAAP,EAAc;AACd,QAAIA,KAAK,CAACF,QAAN,IAAkBE,KAAK,CAACF,QAAN,CAAeG,MAAf,KAA0B,GAAhD,EAAqD;AACnD,YAAM,IAAIC,KAAJ,CAAU,yFAAV,CAAN;AACD;;AACD,UAAMF,KAAN;AACD;;AAED,QAAMG,IAAI,GAAGL,QAAQ,CAACM,IAAT,CAAcC,IAA3B;AACA,QAAMC,OAAO,GAAGR,QAAQ,CAACM,IAAT,CAAcG,GAAd,CAAkBD,OAAlC;AACA,QAAME,WAAW,GAAGV,QAAQ,CAACM,IAAT,CAAcK,IAAd,CAAmBC,IAAvC;AACA,QAAMC,WAAW,GAAGb,QAAQ,CAACM,IAAT,CAAcQ,OAAd,CAAsB,CAAtB,EAAyBD,WAA7C;AAEAD,EAAAA,IAAI,CAACE,OAAL,GAAe;AAAET,IAAAA,IAAF;AAAQG,IAAAA,OAAR;AAAiBE,IAAAA,WAAjB;AAA8BG,IAAAA;AAA9B,GAAf;AACD,CArBD;;AAuBA,OAAOvB,QAAQ,EAAf","sourceRoot":"/var/lib/jenkins/workspace/build-linux/modules/examples/src/backend","sourcesContent":["const axios = require('axios')\n\n/**\n * Gets current weather\n * @title Get Weather\n * @category Weather\n * @author Botpress\n */\nconst myAction = async () => {\n  const config = await bp.config.getModuleConfig('examples')\n  const apiKey = config.openWeatherApiKey\n  const query = event.payload.text\n\n  let response\n  try {\n    response = await axios.get(`http://api.openweathermap.org/data/2.5/weather?q=${query}&units=metric&appid=${apiKey}`)\n  } catch (error) {\n    if (error.response && error.response.status === 401) {\n      throw new Error('Request failed with status code 401. Have you set up your OpenWeather API Key properly?')\n    }\n    throw error\n  }\n\n  const city = response.data.name\n  const country = response.data.sys.country\n  const temperature = response.data.main.temp\n  const description = response.data.weather[0].description\n\n  temp.weather = { city, country, temperature, description }\n}\n\nreturn myAction()\n"]}